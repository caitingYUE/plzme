<!-- pages/custom-scripts/custom-scripts.wxml -->
<view class="custom-scripts-page">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="header-title">æˆ‘çš„è‡ªå®šä¹‰å‰§æœ¬</text>
    <text class="header-subtitle">{{customScripts.length}}ä¸ªä¸“å±å‰§æœ¬</text>
  </view>

  <!-- å‰§æœ¬åˆ—è¡¨ -->
  <view class="scripts-container" wx:if="{{customScripts.length > 0}}">
    <view 
      class="script-card"
      wx:for="{{customScripts}}"
      wx:key="id"
      bindtap="goToScriptDetail"
      data-script="{{item}}"
    >
      <view class="script-image-container">
        <image 
          class="script-image" 
          src="{{item.cover}}" 
          mode="aspectFill"
          lazy-load
        />
        <view class="custom-badge {{item.isDraft ? 'draft' : ''}}">{{item.isDraft ? 'è‰ç¨¿' : 'è‡ªå®šä¹‰'}}</view>
      </view>
      
      <view class="script-info">
        <view class="script-header">
          <text class="script-title">{{item.title}}</text>
          <view class="script-role">{{item.roleText}}</view>
        </view>
        
        <text class="script-description">{{item.description}}</text>
        
        <view class="script-tags">
          <text 
            class="script-tag"
            wx:for="{{item.tags}}"
            wx:for-item="tag"
            wx:key="*this"
          >{{tag}}</text>
        </view>
        
        <view class="script-footer">
          <text class="create-time">åˆ›å»ºäº {{item.timeText}}</text>
          <view class="script-actions">
            <text class="action-btn" bindtap="editScript" data-script="{{item}}" catchtap="true">{{item.isDraft ? 'ç»§ç»­ç¼–è¾‘' : 'ç¼–è¾‘'}}</text>
            <text class="action-btn delete" bindtap="deleteScript" data-script="{{item}}" catchtap="true">åˆ é™¤</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{customScripts.length === 0 && !loading}}">
    <view class="empty-icon">ğŸ­</view>
    <text class="empty-title">è¿˜æ²¡æœ‰è‡ªå®šä¹‰å‰§æœ¬</text>
    <text class="empty-desc">åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªä¸“å±å‰§æœ¬å§</text>
    <button class="create-first-btn" bindtap="goToCreateScript">
      âœ¨ ç«‹å³åˆ›å»º
    </button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- åº•éƒ¨æµ®åŠ¨åˆ›å»ºæŒ‰é’® -->
  <view class="floating-create-btn" wx:if="{{customScripts.length > 0}}" bindtap="goToCreateScript">
    <text class="create-icon">+</text>
  </view>
</view>

<!-- åˆ é™¤ç¡®è®¤å¼¹çª— -->
<view class="delete-modal {{showDeleteModal ? 'show' : ''}}" wx:if="{{showDeleteModal}}">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">ç¡®è®¤åˆ é™¤</text>
    </view>
    <view class="modal-body">
      <text class="modal-text">ç¡®å®šè¦åˆ é™¤å‰§æœ¬"{{deleteScript.title}}"å—ï¼Ÿ</text>
      <text class="modal-warning">åˆ é™¤åæ— æ³•æ¢å¤</text>
    </view>
    <view class="modal-footer">
      <button class="modal-btn cancel" bindtap="cancelDelete">å–æ¶ˆ</button>
      <button class="modal-btn confirm" bindtap="confirmDelete">åˆ é™¤</button>
    </view>
  </view>
</view> 