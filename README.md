# PlzMe 微信小程序 - AI互动心理剧

## 📋 项目概述

PlzMe 是一款创新的微信小程序，专为 27-35 岁女性设计，通过 AI 驱动的心理剧互动实现情感疗愈和自我成长。产品口号"我是我的人生主角"体现了其核心使命：让用户掌控自己的情感成长之旅。

## ✨ 核心功能

- **AI 心理剧导演**: 引导用户进行沉浸式角色扮演体验
- **深夜疗愈 UI 主题**: 专为夜间情感疗愈设计的深色界面
- **剧本互动系统**: 基于真实故事的心理剧本，支持选择卡和自由输入
- **AI 工具箱**: 内心独白、关系报告、自定义剧情生成
- **高能女主模式**: 长按头像激活，提供高自信 AI 回应
- **多级缓存系统**: 优化性能，提升用户体验

## 🛠️ 技术架构

### 前端技术栈
- **微信小程序**: 原生开发框架
- **AI 集成**: DeepSeek API
- **存储管理**: 多级缓存 + 本地存储
- **状态管理**: 单例模式 + 全局状态

### 核心模块
- `utils/script-manager.js` - 剧本管理器(单例模式)
- `utils/deepseek-client.js` - AI客户端
- `utils/cache-manager.js` - 多级缓存管理
- `utils/enhanced-chat-manager.js` - 增强聊天管理
- `utils/storage-manager.js` - 存储管理器

### 性能优化
- **缓存策略**: L1内存缓存 + L2会话缓存
- **AI请求优化**: 智能缓存，减少API调用
- **存储优化**: 批量操作、自动压缩
- **响应速度**: AI回复从6秒降至3秒

## 🚀 开发环境配置

### 环境要求
- Node.js >= 16.0.0
- 微信开发者工具 >= 1.06.0
- npm >= 8.0.0

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd plzme_v2_副本
```

2. **安装依赖**
```bash
npm install
```

3. **配置微信开发者工具**
- 打开微信开发者工具
- 导入项目
- 配置 AppID 或使用测试号

4. **启动开发**
```bash
npm run dev
```

## 📁 项目结构

```
plzme_v2_副本/
├── app.js                 # 应用入口
├── app.json              # 应用配置
├── app.wxss             # 全局样式
├── pages/               # 页面目录
│   ├── index/          # 首页
│   ├── chat/           # 对话页面
│   ├── scripts/        # 剧本选择页面
│   ├── script-detail/  # 剧本详情页面
│   └── profile/        # 个人中心
├── components/         # 自定义组件
├── utils/              # 工具模块
│   ├── cache-manager.js      # 缓存管理器
│   ├── script-manager.js     # 剧本管理器
│   ├── deepseek-client.js    # AI客户端
│   └── storage-manager.js    # 存储管理器
├── data/               # 数据文件
└── assets/             # 静态资源
```

## 🔧 核心配置

### API配置
在 `app.js` 中配置后端API地址：
```javascript
globalData: {
  apiURL: 'http://127.0.0.1:5001',  // 后端API地址
  deepSeekApiKey: 'your-api-key-here'  // DeepSeek API密钥
}
```

### 域名配置
在微信开发者工具中配置域名白名单：
- request合法域名: `your-backend-domain.com`
- socket合法域名: `your-websocket-domain.com`

## 📊 性能指标

| 优化项目 | 优化前 | 优化后 | 提升幅度 |
|---------|--------|--------|----------|
| **内存使用** | 基线100% | 60-70% | **减少30-40%** |
| **AI响应速度** | 5-8秒 | 2-4秒 | **提升50-80%** |
| **存储I/O** | 基线100% | 30-40% | **减少60-70%** |
| **缓存命中率** | 0% | >70% | **新增功能** |

## 🐛 常见问题

### 1. AI回复失败
- 检查网络连接
- 确认API密钥配置正确
- 查看控制台错误信息

### 2. 图片加载失败
- 检查图片路径是否正确
- 确认图片大小符合小程序要求
- 检查域名白名单配置

### 3. 缓存问题
- 在开发者工具中清除缓存
- 重新编译项目
- 检查存储空间使用情况

## 📝 更新日志

### v2.0 (2024-12)
- ✅ 完整缓存体系重构
- ✅ 性能显著提升(30-80%)
- ✅ AI请求优化
- ✅ 存储管理优化
- ✅ 单例模式管理

### v1.0 (2024-06)
- ✅ 基础功能实现
- ✅ 微信小程序框架搭建
- ✅ AI对话系统集成

## 📄 许可证

MIT License

## 👥 贡献

欢迎提交 Issue 和 Pull Request！

---

**开发团队**: PlzMe Team  
**技术支持**: support@plzme.com  
**最后更新**: 2024年12月
